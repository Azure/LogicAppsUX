name: Playwright Tests - Nightly
on:
  push:
    branches: [e2eTesting]


jobs:

  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
        issues: write
        pull-requests: write
        id-token: write
    steps:
    - uses: actions/checkout@v4
    - name: Azure login
      uses: azure/login@v2
      with:
        client-id: ${{ secrets.AZURE_TESTING_CLIENT_ID }}
        tenant-id: ${{ secrets.AZURE_TESTING_TENANT_ID }}
        subscription-id: ${{ secrets.AZURE_TESTING_SUBSCRIPTION_ID }}

    - name: Azure CLI script
      uses: azure/cli@v2
      with:
        azcliversion: 2.30.0
        inlineScript: |
            az deployment group create \
            --resource-group LAE2ETESTING \
            --subscription ${{ secrets.AZURE_TESTING_SUBSCRIPTION_ID }} \
            --template-file ./e2e/testSetup/BlankLogicApp/logicAppStandard.bicep
