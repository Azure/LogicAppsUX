import { Meta } from '@storybook/addon-docs';

<Meta title="Docs/Data Mapper" />

# Data Mapper (VS Code / Portal)

## Architecture

### Purpose

To provide a graphical way to map data from an input schema to an output schema using direct mappings and expressions, handling any translation between supported schema types in the backend

### Data Flow

From a fresh start, the data we handle translates/transforms in the following flow:

1. .xsd (XML) Schemas
2. Backend - getSchemaTree (takes any supported schema format and returns it as JSON)
3. Internal state management of schema/schemaExtended
4. onSave - data map definition saved as .yml, and .xslt generated by backend and saved

## VS Code Extension

### Prereqs

Make sure you've git-cloned and npm-installed-in the logic_apps_designer repo

### Build

To build, run the following commands in order (from the root of the repo folder):

```bash
nx build vs-code-data-mapper
```

```bash
nx build vs-code-data-mapper-react
```

### Run

To run the VS Code extension (in debug mode), ensure you have the repo folder opened in VS Code,
then click the 'Run and Debug' tab on the left (Activity) bar. Make sure 'Run Data Mapper Extension...'
is selected in the dropdown at the top, then click the 'Start debugging' icon

### Functionality

The extension activates/initializes automatically upon viewing the Azure Tools extension tree, or by having a Logic Apps workflow folder open in your VS Code workspace

- Context menu - load data map and schema files
- Azure Tools view - create new data map
- Within Data Mapper component - ConfigPane (choosing schemas) for existing schema files; save data maps to filesystem

## Backend

Data Mapper UX relies on its backend for the following:

- Schema translation (getSchemaTree - translates any supported schema format to JSON)
- .XSLT generation (formats a data map with all of its nodes/expressions/connections into a common .xslt format)
- Testing connections (ensuring that any connections, including expressions, produce the expected output)

### API & Frontend/Backend Integration

Currently in development
